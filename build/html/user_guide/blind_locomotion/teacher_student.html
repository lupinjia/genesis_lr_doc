

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>üßë‚Äçüè´üßë‚Äçüè´ Teacher-Student Framework &#8212; genesis_lr  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/blind_locomotion/teacher_student';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="‚è±Ô∏è Explicit Estimator" href="explicit_estimator.html" />
    <link rel="prev" title="‚õï Walk These Ways" href="walk_these_ways.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">genesis_lr  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    User Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">üõ†Ô∏èInstallation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quick_start.html">üöÄQuick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/deploy_to_real_robot.html">‚¨áÔ∏èDeploy to Real Robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/code_architecture.html">üß¨Code Architecture</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Blind Locomotion</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="walk_these_ways.html">‚õï Walk These Ways</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">üßë‚Äçüè´üßë‚Äçüè´ Teacher-Student Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="explicit_estimator.html">‚è±Ô∏è Explicit Estimator</a></li>
<li class="toctree-l1"><a class="reference internal" href="dreamwaq.html">DreamWaQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="sim2real_skills.html">Sim2real Skills</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">User Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">üßë‚Äçüè´üßë‚Äçüè´ Teacher-Student Framework</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="teacher-student-framework">
<h1>üßë‚Äçüè´üßë‚Äçüè´ Teacher-Student Framework<a class="headerlink" href="#teacher-student-framework" title="Permalink to this heading">#</a></h1>
<p>In <a class="reference internal" href="walk_these_ways.html"><span class="std std-doc">Walk These Ways</span></a>, we know that through tuning robot behaviors, we can let a policy trained on flat ground traverse some difficult terrains (like small curbs and stairs). It indicates generalization ability of the policy since it has been only trained on flat ground and data concerning complex terrains are not included in the training dataet. However, to achieve better stability and traversability on complex terrains, training on terrains are inavoidable. But as introduced in <a class="reference external" href="https://genesis-lr.readthedocs.io/en/latest/user_guide/getting_started/deploy_to_real_robot.html">deploy_to_real_robot</a>, just a simple network that gets robot state feedback of one time step is not enough. Actually, if you use RNN or stack observation of multiple time steps, the policy will gain better ability to adapt to terrains. However, we still need some mechanism to effectively extract key information from observation history and endow the policy with better understanding of the robot and the surrounding environment.</p>
<section id="id1">
<h2>Teacher-Student Framework<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>As one of the pioneer of RL-based control on legged robots, <a class="reference external" href="https://rsl.ethz.ch/">RSL from ETH zurich</a> has proposed a series of works to push the limit of quadruped robots on complex terrains. The one introduced here is teacher-student framework.</p>
<p>Intuitively, we understand that with privilege information(base_lin_vel, friction_ratio, added_mass, base_com_bias e.t.c) the locomotion problem can be seen as MDP(Markov Decision Process) instead of POMDP(Partially Observable Markov Decision Process). The policy can find better solution with more useful information. However, in real world, privilege information is not observable. But instead, it can be estimated. <strong>The key insight of teacher-student framework is that privilege information can be estimated from observation history.</strong> The simplified diagram of teacher-student is shown as below, where <span class="math notranslate nohighlight">\(x_t\)</span> is privileged information, <span class="math notranslate nohighlight">\(o_t^H=[o_t, o_{t-1},...,o_{t-H+1}]\)</span> is observation history with length of H steps, <span class="math notranslate nohighlight">\(l_t\)</span> is encoded latent vector from teacher encoder, <span class="math notranslate nohighlight">\(\hat{l}_t\)</span> is predicted latent vector from student encoder, <span class="math notranslate nohighlight">\(a_t\)</span> is the action, <span class="math notranslate nohighlight">\(s_t\)</span> is the state of the environment, <span class="math notranslate nohighlight">\(\hat{V}_t\)</span> is the estimated value from the critic.</p>
<figure class="align-default">
<img alt="../../_images/ts_diagram.png" src="../../_images/ts_diagram.png" />
</figure>
<p>The privilege encoder(or teacher encoder) encodes privilege information into latent space with the same dimension. The history encoder(or student encoder) infers latent vectors of privilege information from observation history. The policy observes current observation and latent vectors, and outputs actions.</p>
<p>The original teacher-student framework is a two-stage training framework, where encoder and actor are coupled. The teacher encoder and teacher policy are trained in the first stage, and the student encoder and student policy are trained in the second stage. To simplify the training process, RMA<span class="math notranslate nohighlight">\(^2\)</span> proposed to decouple the encoder and policy, only requiring training student encoder in the second stage. Furthermore, RLvRL<span class="math notranslate nohighlight">\(^3\)</span> proposed to achieve one-stage training by concurrently conducting reinforcement learning and supervised learning. The above diagram is the same as the method of RLvRL.</p>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">#</a></h2>
<p>We implement a one-stage teacher-student training framework based on RLvRL<span class="math notranslate nohighlight">\(^3\)</span>. The core modification compared to standard actor-critic is in <code class="docutils literal notranslate"><span class="pre">actor_critic_ts.py</span></code> and <code class="docutils literal notranslate"><span class="pre">ppo_ts.py</span></code>. In <code class="docutils literal notranslate"><span class="pre">actor_critic_ts.py</span></code>, we add privilege encoder and history encoder as neural network modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># actor_critic_ts.py</span>
        <span class="c1"># Privilege encoder</span>
        <span class="n">privilege_encoder_layers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">privilege_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_privilege_encoder_input</span><span class="p">,</span> <span class="n">privilege_encoder_hidden_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">privilege_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">privilege_encoder_hidden_dims</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">privilege_encoder_hidden_dims</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">privilege_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">privilege_encoder_hidden_dims</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">num_latent_dims</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">privilege_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                    <span class="n">privilege_encoder_hidden_dims</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">privilege_encoder_hidden_dims</span><span class="p">[</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
                <span class="n">privilege_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">privilege_encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">privilege_encoder_layers</span><span class="p">)</span>

        <span class="c1"># History encoder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_encoder_type</span> <span class="o">=</span> <span class="n">history_encoder_type</span>
        <span class="n">history_encoder_layers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">history_encoder_type</span> <span class="o">==</span> <span class="s2">&quot;MLP&quot;</span><span class="p">:</span>
            <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">num_history_encoder_input</span><span class="p">,</span> <span class="n">history_encoder_hidden_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">history_encoder_hidden_dims</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">history_encoder_hidden_dims</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">history_encoder_hidden_dims</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">num_latent_dims</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">history_encoder_hidden_dims</span><span class="p">[</span><span class="n">l</span><span class="p">],</span> <span class="n">history_encoder_hidden_dims</span><span class="p">[</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]))</span>
                    <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history_encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">history_encoder_layers</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">history_encoder_type</span> <span class="o">==</span> <span class="s2">&quot;TCN&quot;</span><span class="p">:</span>
            <span class="n">in_channels</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">history_encoder_channel_dims</span><span class="p">)):</span>
                <span class="n">out_channels</span> <span class="o">=</span> <span class="n">history_encoder_channel_dims</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
                <span class="n">padding</span> <span class="o">=</span> <span class="n">history_encoder_dilation</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span> <span class="mi">2</span>
                <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span>
                              <span class="n">stride</span><span class="o">=</span><span class="n">history_encoder_stride</span><span class="p">[</span><span class="n">l</span><span class="p">],</span>
                              <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
                              <span class="n">dilation</span><span class="o">=</span><span class="n">history_encoder_dilation</span><span class="p">[</span><span class="n">l</span><span class="p">])</span>
                <span class="p">)</span>
                <span class="n">in_channels</span> <span class="o">=</span> <span class="n">out_channels</span>
                <span class="n">num_history_encoder_input</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_history_encoder_input</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">history_encoder_stride</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">history_encoder_output_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                <span class="n">num_history_encoder_input</span> <span class="o">*</span> <span class="n">history_encoder_channel_dims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">history_encoder_final_layer_dim</span><span class="p">)</span>
            <span class="n">history_encoder_output_activation</span> <span class="o">=</span> <span class="n">activation</span>
            <span class="n">history_encoder_latent_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
                <span class="n">history_encoder_final_layer_dim</span><span class="p">,</span> <span class="n">num_latent_dims</span><span class="p">)</span>
            <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">())</span>
            <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">history_encoder_output_layer</span><span class="p">)</span>
            <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">history_encoder_output_activation</span><span class="p">)</span>
            <span class="n">history_encoder_layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">history_encoder_latent_layer</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history_encoder</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">history_encoder_layers</span><span class="p">)</span>
</pre></div>
</div>
<p>In training, we update the privilege encoder through reinforcement learning and update the history encoder through supervised learning:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>            <span class="n">loss</span> <span class="o">=</span> <span class="n">surrogate_loss</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_loss_coef</span> <span class="o">*</span> \
                <span class="n">value_loss</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">entropy_coef</span> <span class="o">*</span> <span class="n">entropy_batch</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

            <span class="c1"># Gradient step</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
            <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
            <span class="n">nn</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">clip_grad_norm_</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">actor_critic</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_grad_norm</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
            
            <span class="c1"># history encoder gradient step</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_encoder_epochs</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor_critic</span><span class="o">.</span><span class="n">history_encoder_type</span> <span class="o">==</span> <span class="s2">&quot;TCN&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">obs_histories_batch</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="c1"># input shape (batch_size, obs_history_len) -&gt; (batch_size, 1, obs_history_len)</span>
                        <span class="n">obs_histories_batch</span> <span class="o">=</span> <span class="n">obs_histories_batch</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">encoder_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor_critic</span><span class="o">.</span><span class="n">history_encoder</span><span class="p">(</span><span class="n">obs_histories_batch</span><span class="p">)</span>
                
                <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span> <span class="c1"># don&#39;t backpropagate through the encoder targets</span>
                    <span class="n">encoder_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actor_critic</span><span class="o">.</span><span class="n">privilege_encoder</span><span class="p">(</span><span class="n">privileged_obs_batch</span><span class="p">)</span>

                <span class="n">encoder_loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span> <span class="c1"># use mse loss</span>
                    <span class="n">encoder_predictions</span><span class="p">,</span> <span class="n">encoder_targets</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_encoder_optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
                <span class="n">encoder_loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">history_encoder_optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="asymmetric-actor-critic-a2c">
<h2>Asymmetric Actor Critic(A2C)<a class="headerlink" href="#asymmetric-actor-critic-a2c" title="Permalink to this heading">#</a></h2>
<p>To bridge sim-to-real gap, we usually add noise to the observation of actor. If we give the same observation to the critic, then the critic has to estimate the value from noisy observation, which is difficult. Instead, we can give critic noise-free privilege state obtained from simulation so that it can estimate the value more precisely. This aymmetric actor critic(A2C)<span class="math notranslate nohighlight">\(^4\)</span> architecture won‚Äôt hinder sim-to-real transfer because the critic network will only function in simulation.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">go2_ts.py</span></code>, we use two buffers for <code class="docutils literal notranslate"><span class="pre">critic_obs(input</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">critic</span> <span class="pre">network)</span></code> and <code class="docutils literal notranslate"><span class="pre">privilege_obs(input</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">privilege</span> <span class="pre">encoder)</span></code> separately.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># In go2_ts.py</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">commands</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">commands_scale</span><span class="p">,</span>                     <span class="c1"># 3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">projected_gravity</span><span class="p">,</span>                                         <span class="c1"># 3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">base_ang_vel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_scales</span><span class="o">.</span><span class="n">ang_vel</span><span class="p">,</span>                   <span class="c1"># 3</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">dof_pos</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">default_dof_pos</span><span class="p">)</span> <span class="o">*</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obs_scales</span><span class="o">.</span><span class="n">dof_pos</span><span class="p">,</span>  <span class="c1"># num_dofs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">dof_vel</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_scales</span><span class="o">.</span><span class="n">dof_vel</span><span class="p">,</span>                         <span class="c1"># num_dofs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actions</span>                                                    <span class="c1"># num_actions</span>
        <span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">domain_randomization_info</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_friction_values</span> <span class="o">-</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">friction_value_offset</span><span class="p">),</span>            <span class="c1"># 1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_added_base_mass</span><span class="p">,</span>        <span class="c1"># 1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_base_com_bias</span><span class="p">,</span>          <span class="c1"># 3</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_rand_push_vels</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># 2</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_kp_scale</span> <span class="o">-</span> 
                     <span class="bp">self</span><span class="o">.</span><span class="n">kp_scale_offset</span><span class="p">),</span>                 <span class="c1"># num_actions</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_kd_scale</span> <span class="o">-</span> 
                     <span class="bp">self</span><span class="o">.</span><span class="n">kd_scale_offset</span><span class="p">),</span>                 <span class="c1"># num_actions</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_joint_armature</span><span class="p">,</span>         <span class="c1"># 1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_joint_stiffness</span><span class="p">,</span>        <span class="c1"># 1</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">_joint_damping</span><span class="p">,</span>          <span class="c1"># 1</span>
            <span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># Critic observation</span>
        <span class="n">critic_obs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span><span class="p">,</span>                 <span class="c1"># num_observations</span>
            <span class="n">domain_randomization_info</span><span class="p">,</span>    <span class="c1"># 34</span>
        <span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">asset</span><span class="o">.</span><span class="n">obtain_link_contact_states</span><span class="p">:</span>
            <span class="n">critic_obs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">critic_obs</span><span class="p">,</span>                         <span class="c1"># previous</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">link_contact_states</span><span class="p">,</span>  <span class="c1"># contact states of thighs, calfs and feet (4+4+4)=12</span>
                <span class="p">),</span>
                <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">terrain</span><span class="o">.</span><span class="n">measure_heights</span><span class="p">:</span> <span class="c1"># 81</span>
            <span class="n">heights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">base_pos</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span>
                <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">measured_heights</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_scales</span><span class="o">.</span><span class="n">height_measurements</span>
            <span class="n">critic_obs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">critic_obs</span><span class="p">,</span> <span class="n">heights</span><span class="p">),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critic_obs_deque</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">critic_obs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critic_obs_buf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">critic_obs_deque</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">critic_obs_deque</span><span class="o">.</span><span class="n">maxlen</span><span class="p">)],</span>
            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="c1"># add noise if needed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_noise</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span><span class="p">)</span> <span class="o">-</span>
                             <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_scale_vec</span>

        <span class="c1"># push obs_buf to obs_history</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs_history_deque</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_buf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs_history</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_history_deque</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs_history_deque</span><span class="o">.</span><span class="n">maxlen</span><span class="p">)],</span>
            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        
        <span class="c1"># Privileged observation, for privileged encoder</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_privileged_obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">privileged_obs_buf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">(</span>
                    <span class="n">domain_randomization_info</span><span class="p">,</span>                       <span class="c1"># 34</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">height_around_feet</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>  <span class="c1"># 9*number of feet</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">normal_vector_around_feet</span><span class="p">,</span>        <span class="c1"># 3*number of feet</span>
                <span class="p">),</span>
                <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">asset</span><span class="o">.</span><span class="n">obtain_link_contact_states</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">privileged_obs_buf</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">privileged_obs_buf</span><span class="p">,</span>                   <span class="c1"># previous</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">simulator</span><span class="o">.</span><span class="n">link_contact_states</span><span class="p">,</span>        <span class="c1"># contact states of thighs, calfs and feet (4+4+4)=12</span>
                    <span class="p">),</span>
                    <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="ablation-of-tcn-temporal-convolutional-network">
<h2>Ablation of TCN(Temporal Convolutional Network)<a class="headerlink" href="#ablation-of-tcn-temporal-convolutional-network" title="Permalink to this heading">#</a></h2>
<p>In the original teacher-student paper<span class="math notranslate nohighlight">\(^1\)</span>, authors used TCN as the body of student encoder and compared its computation efficiency with GRU. Here we did an ablation study of TCN to see whether using TCN can bring lower prediction loss and faster training speed. We set history length to 100(corresponds to a history window of 2s). As shown in below two figures, we can see that the total reward is almost the same, but the encoder loss(i.e. prediction loss) of TCN is larger. Meanwhile, the collection_time(time to collect data for one iteration) of both are the same, yet the learning_time(time to update neural networks) of TCN is nearly five times as much as that of MLP.</p>
<figure class="align-default">
<img alt="../../_images/ts_total_reward_comparison.png" src="../../_images/ts_total_reward_comparison.png" />
</figure>
<figure class="align-default">
<img alt="../../_images/ts_encoder_loss_comparison.png" src="../../_images/ts_encoder_loss_comparison.png" />
</figure>
<figure class="align-default">
<img alt="../../_images/ts_collection_time_com.png" src="../../_images/ts_collection_time_com.png" />
</figure>
<figure class="align-default">
<img alt="../../_images/ts_learning_time_com.png" src="../../_images/ts_learning_time_com.png" />
</figure>
</section>
<section id="demonstration">
<h2>Demonstration<a class="headerlink" href="#demonstration" title="Permalink to this heading">#</a></h2>
<p>Here we show the demo of running a policy trained using teacher-student framework with a history length of 20.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/2010.11251">Learning Quadrupedal Locomotion over Challenging Terrain</a></p></li>
<li><p><a class="reference external" href="https://ashish-kmr.github.io/rma-legged-robots/">RMA: Rapid Motor Adaptation for Legged Robots</a></p></li>
<li><p><a class="reference external" href="https://agility.csail.mit.edu/">Rapid Locomotion via Reinforcement Learning</a></p></li>
<li><p><a class="reference external" href="https://arxiv.org/abs/1710.06542">Asymmetric Actor Critic for Image-Based Robot Learning</a></p></li>
</ol>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="walk_these_ways.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">‚õï Walk These Ways</p>
      </div>
    </a>
    <a class="right-next"
       href="explicit_estimator.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">‚è±Ô∏è Explicit Estimator</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Teacher-Student Framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#asymmetric-actor-critic-a2c">Asymmetric Actor Critic(A2C)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ablation-of-tcn-temporal-convolutional-network">Ablation of TCN(Temporal Convolutional Network)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demonstration">Demonstration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/lupinjia/genesis_lr/edit/dev//source/user_guide/blind_locomotion/teacher_student.md">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/user_guide/blind_locomotion/teacher_student.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      ¬© Copyright 2025, lupinjia.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>